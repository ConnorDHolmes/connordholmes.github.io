"use strict";const root=document.documentElement,body=document.body,nav=document.querySelector("nav"),startButton=document.getElementById("start"),email=document.querySelector("footer span"),resButton=document.getElementById("res"),hiddenKey=document.querySelector("c-control[hide]"),hoverables=[...document.querySelectorAll("[data-h]")],list=document.querySelector("ul"),listEntries=list.querySelectorAll("li"),entryCount=listEntries.length,listPairs=new Map,frameDurationBenchmark=1e3/60,win={get w(){return window.innerWidth},get h(){return window.innerHeight},get midX(){return win.w/2},get midY(){return win.h/2}},sceneEl=document.querySelector("c-scene"),scene={get h(){return sceneEl.offsetHeight},get scale(){return win.h/scene.h}},cursorEl=document.querySelector("c-cursor"),cursor={x:{target:win.midX,eased:win.midX},y:{target:win.midY,eased:win.midY},half:.5*cursorEl.offsetWidth},camera=new Map([["orbit",{hor:3,vert:2,zoom:-864,adj:90}],["normal",{hor:95,vert:50,zoom:512,adj:0}],["focused",{hor:1,vert:1,zoom:576,adj:0}],]),roomEl=document.querySelector("c-room"),room={range:{mode:"orbit",hor:{get target(){return camera.get(room.range.mode).hor},eased:3,get cone(){return 2*room.range.hor.eased},get isInactive(){return .5>Math.abs(this.target-this.eased)}},vert:{get target(){return camera.get(room.range.mode).vert},eased:2,get cone(){return 2*room.range.vert.eased},get isInactive(){return .5>Math.abs(this.target-this.eased)}},zoom:{get target(){return camera.get(room.range.mode).zoom},eased:-1024,get isInactive(){return .5>Math.abs(this.target-this.eased)}},adj:{get target(){return camera.get(room.range.mode).adj},eased:90,get isInactive(){return .5>Math.abs(this.target-this.eased)}}},x:{get target(){return cursor.x.target},eased:cursor.x.target},y:{get target(){return cursor.y.target},eased:cursor.y.target},get pan(){return-room.range.hor.eased+room.x.eased/win.w*room.range.hor.cone+room.range.adj.eased},get tilt(){return room.range.vert.eased-room.y.eased/win.h*room.range.vert.cone}},easedTraits=[cursor.x,cursor.y,room.x,room.y,room.range.hor,room.range.vert,room.range.zoom,room.range.adj,],actions=new Map([[startButton,()=>{addCl(nav,"hide"),setTimeout(()=>{room.range.mode="focused",remBl(hiddenKey,"hide"),remBl(roomEl,"backface"),addCl(nav,"remove"),[...listPairs.keys()].forEach((e,r)=>setTimeout(()=>remCl(e,"hide"),(r+10)*125)),canScroll=!0},350)},],[resButton,()=>window.open("resume_placeholder.pdf","_blank")],]);cursor.x.ease=cursor.y.ease=.25,room.x.ease=room.y.ease=.15,room.range.hor.ease=room.range.vert.ease=room.range.adj.ease=.05,room.range.zoom.ease=.04;let then=document.timeline.currentTime,everyOtherFrame,canScroll=!1;function addCl(e,r){e.classList.contains(r)||requestAnimationFrame(()=>e.classList.add(r))}function remCl(e,r){e.classList.contains(r)&&requestAnimationFrame(()=>e.classList.remove(r))}function togCl(e,r){requestAnimationFrame(()=>e.classList.toggle(r))}function addBl(e,r){e.hasAttribute(r)||requestAnimationFrame(()=>e.setAttribute(r,""))}function remBl(e,r){e.hasAttribute(r)&&requestAnimationFrame(()=>e.removeAttribute(r))}function bindLinks(){document.querySelectorAll("a").forEach(e=>{let r=e.href;actions.set(e,()=>window.open(r,"_blank")),e.removeAttribute("href"),e.removeAttribute("target")})}function cloneListEntries(){let e=document.querySelectorAll("section");listEntries.forEach((r,t)=>{let o=r.cloneNode(!0);listPairs.set(r,o).set(o,r),hoverables.push(o),actions.set(r,()=>{e.forEach((e,r)=>r===t?togCl(e,"show"):remCl(e,"show")),[...listPairs.keys()].forEach(e=>e===r||e===o?togCl(e,"selected"):remCl(e,"selected"))}).set(o,()=>{e.forEach((e,r)=>r===t+entryCount?togCl(e,"show"):remCl(e,"show")),[...listPairs.keys()].forEach(e=>e===r||e===o?togCl(e,"selected"):remCl(e,"selected"))}),list.append(o)})}function cloneScreen(){let e=document.querySelector("c-screen"),r=e.cloneNode(!0),t=new Map,o=new MutationObserver(e=>e.forEach(e=>t.get(e.target).classList=e.target.classList)),a=[...r.querySelectorAll("[data-m], [data-h]"),];a.forEach(e=>["data-m","data-h"].forEach(r=>e.removeAttribute(r))),[...e.querySelectorAll("[data-m], [data-h]")].forEach((e,r)=>{t.set(e,a[r]),o.observe(e,{attributeFilter:["class"]})});let s=t.get(list);s.scrollTop=list.scrollTop=1;let n=(listEntries[0].offsetHeight+parseInt(getComputedStyle(list).getPropertyValue("--gap").split("p")[0]))*entryCount;document.addEventListener("wheel",e=>{canScroll&&(list.scrollTop>=n?s.scrollTop=list.scrollTop=1:0===list.scrollTop?s.scrollTop=list.scrollTop=n-1:s.scrollTop=list.scrollTop+=e.deltaY)},{passive:!0}),document.querySelector("c-reflection").append(r)}function ease(e,r){e.eased+=(e.target-e.eased)*(e.ease*r)}function updateHoveredEl(){let e=document.elementFromPoint(cursor.x.eased,cursor.y.eased);hoverables.includes(e)?(hoverables.forEach(r=>r===e||r===listPairs.get(e)?addCl(r,"hov"):remCl(r,"hov")),addBl(cursorEl,"clickable")):(hoverables.forEach(e=>remCl(e,"hov")),remBl(cursorEl,"clickable"))}function refresh(e){roomEl.style.transform=`translate3d(0, 0, ${room.range.zoom.eased}px) rotate3d(1, 0, 0, ${room.tilt}deg) rotate3d(0, 1, 0, ${room.pan}deg)`,cursorEl.style.transform=`translate3d(${cursor.x.eased}px, ${cursor.y.eased}px, 0)`;let r=(e-then)/frameDurationBenchmark;easedTraits.forEach(e=>!e.isInactive&&ease(e,r)),everyOtherFrame&&!cursorEl.hasAttribute("hide")&&updateHoveredEl(),everyOtherFrame=!everyOtherFrame,(cursor.x.eased>win.w+16||cursor.x.eased<-16||room.x.eased>win.w+16||room.x.eased<-16)&&(cursor.x.eased=win.midX,cursor.y.eased=win.midX,room.x.eased=win.midX,room.y.eased=win.midX),then=e,requestAnimationFrame(refresh)}function measureAndSize(){sceneEl.style.transform=`scale(${scene.scale})`,resetView()}function resetView(){cursor.x.target=win.midX,cursor.y.target=win.midY,addBl(cursorEl,"hide")}function removeSelection(){window.getSelection&&window.getSelection().removeAllRanges(),document.selection&&document.selection.empty()}window.addEventListener("resize",measureAndSize),window.addEventListener("blur",resetView),root.addEventListener("blur",resetView),document.addEventListener("mousemove",e=>{cursor.x.target=e.pageX-cursor.half,cursor.y.target=e.pageY-cursor.half,remBl(cursorEl,"hide")}),root.addEventListener("mouseleave",resetView),root.addEventListener("mouseenter",e=>{cursor.x.eased=e.pageX-cursor.half,cursor.y.eased=e.pageY-cursor.half}),document.addEventListener("keyup",e=>{"Shift"===e.key?"orbit"!==room.range.mode&&("normal"===room.range.mode?room.range.mode="focused":room.range.mode="normal"):"m"===e.key||"M"===e.key?togCl(body,"light-mode"):("e"===e.key||"E"===e.key)&&togCl(body,"performance-mode")}),document.addEventListener("readystatechange",e=>"complete"===e.target.readyState&&remCl(body,"overlay")),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>e.matches?remCl(body,"light-mode"):addCl(body,"light-mode")),document.addEventListener("click",e=>{win.w>768?actions.get(document.querySelector(".hov"))?.():actions.get(e.target)?.(),e.target!==email&&removeSelection()}),window.matchMedia("(prefers-color-scheme: light)").matches&&addCl(body,"light-mode"),document.querySelectorAll("[data-text]").forEach(e=>e.setAttribute("data-text",e.innerHTML)),bindLinks(),cloneListEntries(),cloneScreen(),measureAndSize(),requestAnimationFrame(refresh);