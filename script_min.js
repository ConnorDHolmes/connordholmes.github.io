"use strict";class EasableTrait{constructor(e,t=0){this.target=t,this.eased=t,this.easing=e}get isActive(){return Math.abs(this.target-this.eased)>.001}ease(){this.isActive&&(this.eased+=(this.target-this.eased)*(this.easing*mult))}snap(){this.eased=this.target}}const vw={w:window.innerWidth,h:window.innerHeight,midX:.5*window.innerWidth,midY:.5*window.innerWidth,recalc(){this.w=window.innerWidth,this.h=window.innerHeight,this.midX=.5*this.w,this.midY=.5*this.h}},sn={el:document.querySelector("c-scene"),scale(){this.h=this.el.offsetHeight,this.el.style.transform=`scale(${vw.h/this.el.offsetHeight})`}},rm={el:document.querySelector("c-room"),mode:0,modes:[{hRange:6,vRange:4,zoom:-864,adj:90,rangeEasing:.01},{hRange:180,vRange:100,zoom:512,adj:0,rangeEasing:.04},{hRange:2,vRange:2,zoom:576,adj:0,rangeEasing:.04},],rangeEasing:new EasableTrait(.01,.01),hRange:new EasableTrait(.01,6),vRange:new EasableTrait(.01,4),zoom:new EasableTrait(.01,-864),adj:new EasableTrait(.01,90),x:new EasableTrait(.15,vw.midX),y:new EasableTrait(.15,vw.midY),get pan(){return -.5*this.hRange.eased+this.x.eased/vw.w*this.hRange.eased+this.adj.eased},get tilt(){return .5*this.vRange.eased-this.y.eased/vw.h*this.vRange.eased},setMode(e){this.mode=e,this.hRange.target=this.modes[e].hRange,this.vRange.target=this.modes[e].vRange,this.zoom.target=this.modes[e].zoom,this.adj.target=this.modes[e].adj,this.rangeEasing.target=this.modes[e].rangeEasing},update(){this.el.style.transform=`translate3d(0, 0, ${this.zoom.eased}px) rotate3d(1, 0, 0, ${this.tilt}deg) rotate3d(0, 1, 0, ${this.pan}deg)`}},cs={el:document.querySelector("c-cursor"),x:new EasableTrait(.25,vw.midX),y:new EasableTrait(.25,vw.midY),hf:null,measure(){this.hf=.5*this.el.offsetWidth},update(){this.el.style.transform=`translate3d(${this.x.eased-this.hf}px, ${this.y.eased-this.hf}px, 0)`}},allEasables=[cs.x,cs.y,rm.x,rm.y,rm.hRange,rm.vRange,rm.zoom,rm.adj,rm.rangeEasing,];function easeAll(){rm.adj.easing=rm.hRange.easing=rm.vRange.easing=rm.zoom.easing=rm.rangeEasing.eased,allEasables.forEach(e=>e.ease())}function snapAll(){allEasables.forEach(e=>e.snap())}const root=document.documentElement,body=document.body,nav=document.querySelector("nav"),startButton=document.getElementById("start"),email=document.querySelector("footer span"),resButton=document.getElementById("res"),hiddenKey=document.querySelector("c-control[hide]"),hoverables=[...document.querySelectorAll("[data-h]")],list=document.querySelector("ul"),listEntries=list.querySelectorAll("li"),entryCount=listEntries.length,listPairs=new Map,frameDurationBenchmark=1e3/60,frameDurationMultiplier=1/frameDurationBenchmark,actions=new Map([[startButton,()=>{addCl(nav,"hide"),setTimeout(()=>{rm.setMode(2),remBl(hiddenKey,"hide"),remBl(rm.el,"backface"),addCl(nav,"remove"),[...listPairs.keys()].forEach((e,t)=>setTimeout(()=>remCl(e,"hide"),(t+10)*125)),canScroll=!0},350)},],[resButton,()=>window.open("resume_placeholder.pdf","_blank")],]);let then=document.timeline.currentTime,everyOtherFrame,canScroll=!1,mult=1;function addCl(e,t){e.classList.contains(t)||requestAnimationFrame(()=>e.classList.add(t))}function remCl(e,t){e.classList.contains(t)&&requestAnimationFrame(()=>e.classList.remove(t))}function togCl(e,t){requestAnimationFrame(()=>e.classList.toggle(t))}function addBl(e,t){e.hasAttribute(t)||requestAnimationFrame(()=>e.setAttribute(t,""))}function remBl(e,t){e.hasAttribute(t)&&requestAnimationFrame(()=>e.removeAttribute(t))}function bindLinks(){document.querySelectorAll("a").forEach(e=>{let t=e.href;actions.set(e,()=>window.open(t,"_blank")),e.removeAttribute("href"),e.removeAttribute("target")})}function detectSafari(){navigator.userAgent.indexOf("Safari")>-1&&-1===navigator.userAgent.indexOf("Chrome")&&body.classList.add("safari-compat")}function cloneListEntries(){let e=document.querySelectorAll("section");listEntries.forEach((t,a)=>{let s=t.cloneNode(!0);listPairs.set(t,s).set(s,t),hoverables.push(s),actions.set(t,()=>{e.forEach((e,t)=>t===a?togCl(e,"show"):remCl(e,"show")),[...listPairs.keys()].forEach(e=>e===t||e===s?togCl(e,"selected"):remCl(e,"selected"))}).set(s,()=>{e.forEach((e,t)=>t===a+entryCount?togCl(e,"show"):remCl(e,"show")),[...listPairs.keys()].forEach(e=>e===t||e===s?togCl(e,"selected"):remCl(e,"selected"))}),list.append(s)})}function cloneScreen(){let e=document.querySelector("c-screen"),t=e.cloneNode(!0),a=new Map,s=new MutationObserver(e=>e.forEach(e=>a.get(e.target).classList=e.target.classList)),r=[...t.querySelectorAll("[data-m], [data-h]"),];r.forEach(e=>["data-m","data-h"].forEach(t=>e.removeAttribute(t))),[...e.querySelectorAll("[data-m], [data-h]")].forEach((e,t)=>{a.set(e,r[t]),s.observe(e,{attributeFilter:["class"]})});let i=a.get(list);i.scrollTop=list.scrollTop=1;let l=(listEntries[0].offsetHeight+parseInt(getComputedStyle(list).getPropertyValue("--gap").split("p")[0]))*entryCount;document.addEventListener("wheel",e=>{canScroll&&(list.scrollTop>=l?i.scrollTop=list.scrollTop=1:0===list.scrollTop?i.scrollTop=list.scrollTop=l-1:i.scrollTop=list.scrollTop+=e.deltaY)},{passive:!0}),document.querySelector("c-reflection").append(t)}function updateHoveredEl(){let e=document.elementFromPoint(cs.x.eased,cs.y.eased);hoverables.includes(e)?(hoverables.forEach(t=>t===e||t===listPairs.get(e)?addCl(t,"hov"):remCl(t,"hov")),addBl(cs.el,"clickable")):(hoverables.forEach(e=>remCl(e,"hov")),remBl(cs.el,"clickable"))}function returningToTab(){cs.x.target=cs.x.eased=rm.x.eased=vw.midX,cs.y.target=cs.y.eased=rm.y.eased=vw.midY,snapAll(),hoverables.forEach(e=>remCl(e,"hov")),remBl(cs.el,"clickable"),addBl(cs.el,"hide")}function refresh(e){rm.update(),cs.update(),mult=(e-then)*frameDurationMultiplier,easeAll(),everyOtherFrame&&!cs.el.hasAttribute("hide")&&updateHoveredEl(),everyOtherFrame=!everyOtherFrame,then=e,requestAnimationFrame(refresh)}function measureAndSize(){cs.measure(),vw.recalc(),sn.scale(),resetView()}function resetView(){cs.x.target=rm.x.target=vw.midX,cs.y.target=rm.y.target=vw.midY,addBl(cs.el,"hide")}function removeSelection(){window.getSelection&&window.getSelection().removeAllRanges(),document.selection&&document.selection.empty()}window.addEventListener("resize",measureAndSize),window.addEventListener("blur",returningToTab),root.addEventListener("blur",returningToTab),document.addEventListener("blur",returningToTab),window.addEventListener("visibilitychange",returningToTab),document.addEventListener("focus",returningToTab),document.addEventListener("mousemove",e=>{cs.x.target=rm.x.target=e.pageX,cs.y.target=rm.y.target=e.pageY,remBl(cs.el,"hide")}),root.addEventListener("mouseleave",resetView),root.addEventListener("mouseenter",e=>{cs.x.target=cs.x.eased=e.pageX,cs.x.target=cs.y.eased=e.pageY}),document.addEventListener("keyup",e=>{"Shift"===e.key?0!==rm.mode&&(1===rm.mode?rm.setMode(2):rm.setMode(1)):"m"===e.key||"M"===e.key?togCl(body,"light-mode"):("e"===e.key||"E"===e.key)&&togCl(body,"performance-mode")}),document.addEventListener("readystatechange",e=>"complete"===e.target.readyState&&remCl(body,"overlay")),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>e.matches?remCl(body,"light-mode"):addCl(body,"light-mode")),document.addEventListener("click",e=>{vw.w>768?actions.get(document.querySelector(".hov"))?.():actions.get(e.target)?.(),e.target!==email&&removeSelection()}),window.matchMedia("(prefers-color-scheme: light)").matches&&addCl(body,"light-mode"),document.querySelectorAll("[data-text]").forEach(e=>e.setAttribute("data-text",e.innerHTML)),detectSafari(),bindLinks(),cloneListEntries(),cloneScreen(),measureAndSize(),requestAnimationFrame(refresh);